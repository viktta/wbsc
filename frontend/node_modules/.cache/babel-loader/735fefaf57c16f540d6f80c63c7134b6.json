{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/victor/Documents/Projects/wbsc/frontend/src/User/login.js\";\nimport React, { Component } from \"react\";\nimport axiosInstance from \"../axiosApi\";\nimport jwt_decode from \"jwt-decode\";\nimport axios from \"axios\";\nimport \"../styles/main.css\";\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      username: \"\",\n      password: \"\",\n      token: localStorage.getItem(\"refresh_token\"),\n      user_info_data: []\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.getUserInfo = this.getUserInfo.bind(this);\n  }\n\n  handleChange(event) {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  getUserId(e) {\n    const token = localStorage.getItem(\"refresh_token\");\n    const decode = jwt_decode(token);\n    localStorage.setItem(\"user_id\", decode.user_id);\n  }\n\n  componentDidMount() {\n    const username = localStorage.getItem(\"username\");\n\n    if (username) {//pass\n    } else {\n      this.getUserInfo();\n    }\n  }\n\n  getUserInfo(e) {\n    const id = localStorage.getItem(\"user_id\");\n    axios.get(\"http://127.0.0.1:8000/api/users/\" + id).then(res => {\n      const username = res.data.map(username => {\n        return username.username;\n      });\n      const password = res.data.map(password => {\n        return password.password;\n      });\n      const last_login = res.data.map(last_login => {\n        return last_login.last_login;\n      });\n      const is_superuser = res.data.map(is_superuser => {\n        return is_superuser.is_superuser;\n      });\n      const first_name = res.data.map(first_name => {\n        return first_name.first_name;\n      });\n      const last_name = res.data.map(last_name => {\n        return last_name.last_name;\n      });\n      const email = res.data.map(email => {\n        return email.email;\n      });\n      const is_staff = res.data.map(is_staff => {\n        return is_staff.is_staff;\n      });\n      const is_active = res.data.map(is_active => {\n        return is_active.is_active;\n      });\n      const date_joined = res.data.map(date_joined => {\n        return date_joined.date_joined;\n      });\n      localStorage.setItem(\"username\", username);\n      localStorage.setItem(\"password\", password);\n      localStorage.setItem(\"last_login\", last_login);\n      localStorage.setItem(\"is_superuser\", is_superuser);\n      localStorage.setItem(\"first_name\", first_name);\n      localStorage.setItem(\"last_name\", last_name);\n      localStorage.setItem(\"email\", email);\n      localStorage.setItem(\"is_staff\", is_staff);\n      localStorage.setItem(\"is_active\", is_active);\n      localStorage.setItem(\"date_joined\", date_joined);\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n    axiosInstance.post(\"/token/obtain/\", {\n      username: this.state.username,\n      password: this.state.password\n    }).then(result => {\n      axiosInstance.defaults.headers[\"Authorization\"] = \"JWT \" + result.data.access;\n      localStorage.setItem(\"access_token\", result.data.access);\n      localStorage.setItem(\"refresh_token\", result.data.refresh);\n    }).then(() => {\n      this.getUserId();\n    }).then(() => {\n      window.setTimeout(() => {\n        window.history.go(0);\n      }, 1000);\n    }).catch(error => {\n      throw error;\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Login\", /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: this.handleSubmit,\n        className: \"login-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Username:\", /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"username\",\n            type: \"text\",\n            value: this.state.username,\n            onChange: this.handleChange,\n            placeholder: \"Enter Username\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Password:\", /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"password\",\n            type: \"password\",\n            value: this.state.password,\n            onChange: this.handleChange,\n            placeholder: \"Enter Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"submit\",\n          value: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Login;","map":{"version":3,"sources":["/home/victor/Documents/Projects/wbsc/frontend/src/User/login.js"],"names":["React","Component","axiosInstance","jwt_decode","axios","Login","constructor","props","state","username","password","token","localStorage","getItem","user_info_data","handleChange","bind","handleSubmit","getUserInfo","event","setState","target","name","value","getUserId","e","decode","setItem","user_id","componentDidMount","id","get","then","res","data","map","last_login","is_superuser","first_name","last_name","email","is_staff","is_active","date_joined","catch","err","console","log","preventDefault","post","result","defaults","headers","access","refresh","window","setTimeout","history","go","error","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axiosInstance from \"../axiosApi\";\nimport jwt_decode from \"jwt-decode\";\nimport axios from \"axios\";\nimport \"../styles/main.css\";\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      username: \"\",\n      password: \"\",\n      token: localStorage.getItem(\"refresh_token\"),\n      user_info_data: [],\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.getUserInfo = this.getUserInfo.bind(this);\n  }\n\n  handleChange(event) {\n    this.setState({ [event.target.name]: event.target.value });\n  }\n\n  getUserId(e) {\n    const token = localStorage.getItem(\"refresh_token\");\n    const decode = jwt_decode(token);\n    localStorage.setItem(\"user_id\", decode.user_id);\n  }\n\n  componentDidMount() {\n    const username = localStorage.getItem(\"username\");\n    if (username) {\n      //pass\n    } else {\n      this.getUserInfo();\n    }\n    \n  }\n\n  getUserInfo(e) {\n    const id = localStorage.getItem(\"user_id\");\n    axios\n      .get(\"http://127.0.0.1:8000/api/users/\" + id)\n      .then((res) => {\n        const username = res.data.map((username) => {\n          return username.username;\n        });\n        const password = res.data.map((password) => {\n          return password.password;\n        });\n        const last_login = res.data.map((last_login) => {\n          return last_login.last_login;\n        });\n        const is_superuser = res.data.map((is_superuser) => {\n          return is_superuser.is_superuser;\n        });\n        const first_name = res.data.map((first_name) => {\n          return first_name.first_name;\n        });\n        const last_name = res.data.map((last_name) => {\n          return last_name.last_name;\n        });\n        const email = res.data.map((email) => {\n          return email.email;\n        });\n        const is_staff = res.data.map((is_staff) => {\n          return is_staff.is_staff;\n        });\n        const is_active = res.data.map((is_active) => {\n          return is_active.is_active;\n        });\n        const date_joined = res.data.map((date_joined) => {\n          return date_joined.date_joined;\n        });\n        localStorage.setItem(\"username\", username);\n        localStorage.setItem(\"password\", password);\n        localStorage.setItem(\"last_login\", last_login);\n        localStorage.setItem(\"is_superuser\", is_superuser);\n        localStorage.setItem(\"first_name\", first_name);\n        localStorage.setItem(\"last_name\", last_name);\n        localStorage.setItem(\"email\", email);\n        localStorage.setItem(\"is_staff\", is_staff);\n        localStorage.setItem(\"is_active\", is_active);\n        localStorage.setItem(\"date_joined\", date_joined);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n    axiosInstance\n      .post(\"/token/obtain/\", {\n        username: this.state.username,\n        password: this.state.password,\n      })\n      .then((result) => {\n        axiosInstance.defaults.headers[\"Authorization\"] =\n          \"JWT \" + result.data.access;\n        localStorage.setItem(\"access_token\", result.data.access);\n        localStorage.setItem(\"refresh_token\", result.data.refresh);\n      })\n      .then(() => {\n        this.getUserId();\n      })\n      .then(() => {\n        window.setTimeout(() => {\n          window.history.go(0);\n        }, 1000);\n      })\n      .catch((error) => {\n        throw error;\n      });\n  }\n\n  render() {\n    return (\n      <div>\n        Login\n        <form onSubmit={this.handleSubmit} className=\"login-form\">\n          <label>\n            Username:\n            <input\n              name=\"username\"\n              type=\"text\"\n              value={this.state.username}\n              onChange={this.handleChange}\n              placeholder=\"Enter Username\"\n            />\n          </label>\n          <label>\n            Password:\n            <input\n              name=\"password\"\n              type=\"password\"\n              value={this.state.password}\n              onChange={this.handleChange}\n              placeholder=\"Enter Password\"\n            />\n          </label>\n          <input type=\"submit\" value=\"Submit\" />\n        </form>\n      </div>\n    );\n  }\n}\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}